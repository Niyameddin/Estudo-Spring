/*!
 * estudo-spring v1.2.0 (http://github.com/gsag/estudo-spring)
 * 04/10/2015 Guilherme Alves <gsag.dh@gmail.com>
 * Licensed under the MIT license
 */
!function(){"use strict";angular.module("bookcaseApp",["ui.router","ngResource","ngStorage","ui.mask"]),angular.module("bookcaseApp").constant("$config",{baseUrl:"http://localhost:9090",bookApi:"/bookcase/api/books",projectName:"Estudo-Spring"}),angular.module("bookcaseApp").config(function($stateProvider,$urlRouterProvider,$config){$stateProvider.state("bookcase",{url:"/bookcase",templateUrl:"assets/views/partial-bookcase.html",controller:"bookcaseController"}).state("books",{url:"/bookcase/books",templateUrl:"assets/views/partial-books.html",controller:"bookcaseController"}).state("register",{url:"/bookcase/register",templateUrl:"assets/views/partial-register-book.html",controller:"registerBookController"}),$urlRouterProvider.otherwise("/bookcase")}).run(function($state){$state.go("bookcase")})}(),function(){"use strict";angular.module("bookcaseApp").controller("bookcaseController",function($scope,bookcaseService,$localStorage){$scope.errorMessage="",$scope.books={},$scope.hasBooks=!0;var hasBooksLoaded=(function(){var promisedData=bookcaseService.getBooks();promisedData.$promise.then(function(data){$scope.books=data,$localStorage.bookList=$scope.books},function(error){$scope.errorMessage="Aconteceu um problema ao resgatar os dados do servidor. Tente novamente mais tarde. "})["finally"](function(){hasBooksLoaded()})}(),function(){0===$scope.books.length&&($scope.hasBooks=!1)})})}(),function(){"use strict";angular.module("bookcaseApp").controller("navigationController",function($scope,$config){$scope.appName=$config.projectName,$scope.baseUrl=$config.baseUrl})}(),function(){"use strict";angular.module("bookcaseApp").controller("registerBookController",function($scope,bookcaseService,$state){$scope.newBook={isbn:"",title:"",author:"",edition:""},$scope.response={};var resetFields=function(){return{isbn:"",title:"",author:"",edition:""}};$scope.registerNewBook=function(book){$scope.response=bookcaseService.createBook(book),$scope.response?"SUCCESS"==$scope.response.status?($scope.newBook=resetFields(),$state.transitionTo("books")):"WARNING"==$scope.response.status?alert("warning"):alert("error"):$scope.response={status:"NULL",objectType:"null",objectAttributes:"null",defaultMessage:"Houve um problema ao receber a resposta do servidor. Tente novamente daqui alguns instantes."}}})}(),function(){"use strict";angular.module("bookcaseApp").directive("ngHref",["$config",function($config){return function(scope,element,attrs){function ngHref(event){event.target.href=$config.baseUrl+$config.bookApi}element.bind("click",ngHref)}}])}(),function(){"use strict";angular.module("bookcaseApp").factory("attributeFactory",function(){})}(),function(){"use strict";angular.module("bookcaseApp").factory("Book",function($resource,$config){return $resource($config.baseUrl+$config.bookApi+"/:id",{id:"@id"},{update:{method:"PUT"}})})}(),function(){"use strict";angular.module("bookcaseApp").service("bookcaseService",function(Book,$localStorage,$config){var _getBooks=function(){return Book.query()},_createBook=function(newBook){var book=new Book(newBook),responseData={};return book.$save(function(response){var resp=response[Object.keys(response)[0]];$localStorage.bookList.push(resp.objectAttributes),$localStorage.responseData=resp},function(failedResponse){if(failedResponse.data){var resp=failedResponse.data[Object.keys(failedResponse.data)[0]];$localStorage.responseData=resp}}),responseData=$localStorage.responseData,delete $localStorage.responseData,responseData};return{getBooks:_getBooks,createBook:_createBook}})}();
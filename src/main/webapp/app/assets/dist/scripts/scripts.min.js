/*!
 * estudo-spring v1.2.0 (http://github.com/gsag/estudo-spring)
 * 30/09/2015 Guilherme Alves <gsag.dh@gmail.com>
 * Licensed under the MIT license
 */
!function(){"use strict";angular.module("bookcaseApp",["ui.router","ngResource","ngStorage"]),angular.module("bookcaseApp").constant("$config",{baseUrl:"http://localhost:9090",bookApi:"/bookcase/api/books",projectName:"Estudo-Spring"}),angular.module("bookcaseApp").config(function($stateProvider,$urlRouterProvider,$config){$stateProvider.state("bookcase",{url:"/bookcase",templateUrl:"assets/views/partial-bookcase.html",controller:"bookcaseController"}).state("books",{url:"/bookcase/books",templateUrl:"assets/views/partial-bookcase.html",controller:"bookcaseController"}).state("register",{url:"/bookcase/register",templateUrl:"assets/views/partial-register-book.html",controller:"registerBookController"}),$urlRouterProvider.otherwise("/bookcase")}).run(function($state){$state.go("bookcase")})}(),function(){"use strict";angular.module("bookcaseApp").controller("bookcaseController",function($scope,bookcaseService,$localStorage){$scope.errorMessage="",$scope.books={data:[]},$scope.hasBooks=!0;var hasBooksLoaded=(function(){bookcaseService.getBooks.success(function(data){$scope.books={data:data},$localStorage.bookList=$scope.books}).error(function(data,status){$scope.errorMessage="Aconteceu um problema ao resgatar os dados do servidor. Tente novamente mais tarde. "})["finally"](function(){hasBooksLoaded()})}(),function(){0===Object.keys($scope.books.data).length&&($scope.hasBooks=!1)})})}(),function(){"use strict";angular.module("bookcaseApp").controller("navigationController",function($scope,$config){$scope.appName=$config.projectName,$scope.baseUrl=$config.baseUrl})}(),function(){"use strict";angular.module("bookcaseApp").controller("registerBookController",function($scope,bookcaseService,$state){$scope.newBook={isbn:"9999999999991",title:"angular+springmvc",author:"guilherme",edition:"1"},$scope.response={};(function(){$scope.response=bookcaseService.createBook($scope.newBook),$scope.response?"SUCCESS"==$scope.response.status&&$state.transitionTo("books"):$scope.response={status:"NULL",objectType:"null",objectAttributes:"null",defaultMessage:"Houve um problema ao receber a resposta do servidor"}})()})}(),function(){"use strict";angular.module("bookcaseApp").directive("ngHref",["$config",function($config){return function(scope,element,attrs){function ngHref(event){event.target.href=$config.baseUrl+$config.bookApi}element.bind("click",ngHref)}}])}(),function(){"use strict";angular.module("bookcaseApp").factory("attributeFactory",function(){})}(),function(){"use strict";angular.module("bookcaseApp").factory("Book",function($resource,$config){return $resource($config.baseUrl+$config.bookApi+"/:id",{id:"@id"},{update:{method:"PUT"}})})}(),function(){"use strict";angular.module("bookcaseApp").service("bookcaseService",function($http,Book,$localStorage,$config){var _getBooks=function(){return $http.get($config.baseUrl+$config.bookApi)},_createBook=function(newBook){var book=new Book(newBook),responseData={};return book.$save({},function(response){var resp=response[Object.keys(response)[0]];$localStorage.bookList.data.push(resp.objectAttributes),_sortArrayById($localStorage.bookList.data),$localStorage.responseData=resp},function(failedResponse){if(failedResponse.data){var resp=failedResponse.data[Object.keys(failedResponse.data)[0]];$localStorage.responseData=resp}}),responseData=$localStorage.responseData,delete $localStorage.responseData,responseData},_sortArrayById=function(array){array&&array.sort(function(e1,e2){return e1.isbn-e2.isbn})};return{getBooks:_getBooks(),createBook:_createBook}})}();
